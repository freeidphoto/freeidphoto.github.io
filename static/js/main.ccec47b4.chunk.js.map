{"version":3,"sources":["Disclaimer.tsx","Instruction.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Disclaimer","className","Instruction","ID_SPECS","name","height","width","css_guide","instruction_url","MODEL_URLS","App","React","useState","cropper","setCropper","imgURL","setImgURL","resultImgURL","setResultImgURL","composedResultImgURL","setComposedResultImgURL","currentID","setCurrentID","progressPercent","setProgressPercent","model","setModel","MODEL_INPUT_WIDTH","MODEL_INPUT_HEIGHT","inProgress","useEffect","prepareModel","then","m","imageDataToCanvas","imgData","canvas","document","createElement","ctx2","getContext","putImageData","Promise","resolve","urls","totalSize","all","map","u","fetch","p","a","arrayBuffer","Uint8Array","arrays","forEach","length","ret","counter","v","_","set","Container","ProgressBar","animated","hidden","now","DropdownButton","onSelect","eventKey","Number","title","id","idx","Dropdown","Item","href","target","rel","Form","Group","controlId","Label","Control","type","onChange","e","preventDefault","files","match","reader","FileReader","onload","result","readAsDataURL","Button","variant","onClick","event","ctx","getCroppedCanvas","maxHeight","minHeight","maxWidth","minWidth","alpha","imageData","getImageData","to","pica","Pica","origImgData","img","floatArr","Float32Array","floatArr2","j","i","data","k","l","feeds","Tensor","imageDataToFeeds","InferenceSession","create","sess","run","r","pred","Object","values","createImageData","pixelIndex","t","Math","round","reject","inferenceResultToImageData","from","resize","filterData","imgAndMask","mask","applyBackgroundMask","c","toDataURL","alert","disabled","destroy","undefined","getElementById","value","alt","src","onLoad","thisImg","currentTarget","Cropper","aspectRatio","viewMode","minCropBoxWidth","minCropBoxHeight","ready","b1","getElementsByClassName","setAttribute","b2","after","adjustGuide","download","h","naturalHeight","w","naturalWidth","context","fillStyle","fillRect","drawImage","beginPath","moveTo","lineTo","stroke","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","createRoot","render","StrictMode"],"mappings":"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","file":"static/js/main.ccec47b4.chunk.js","sourcesContent":["function Disclaimer() {\n    return (\n        <>\n            <h2 className=\"text-center\">DISCLAIMER</h2>\n            <h6 className=\"text-center\"> Last updated: August 27, 2022 </h6>\n            <h3 className=\"text-center\">WEBSITE DISCLAIMER </h3>\n            <p>\n                The information provided by freeidphoto.com (\"we,\" \"us,\" or \"our\") on freeidphoto.com (the \"Site\") is\n                for general informational purposes only. All information on the Site is provided in good faith, however\n                we make no representation or warranty of any kind, express or implied, regarding the accuracy, adequacy,\n                validity, reliability, availability, or completeness of any information on the Site. UNDER NO\n                CIRCUMSTANCE SHALL WE HAVE ANY LIABILITY TO YOU FOR ANY LOSS OR DAMAGE OF ANY KIND INCURRED AS A RESULT\n                OF THE USE OF THE SITE OR RELIANCE ON ANY INFORMATION PROVIDED ON THE SITE. YOUR USE OF THE SITE AND\n                YOUR RELIANCE ON ANY INFORMATION ON THE SITE IS SOLELY AT YOUR OWN RISK.\n            </p>\n\n            <p>\n                The Site may contain (or you may be sent through the Site) links to other websites or content belonging\n                to or originating from third parties or links to websites and features in banners or other advertising.\n                Such external links are not investigated, monitored, or checked for accuracy, adequacy, validity,\n                reliability, availability, or completeness by us. WE DO NOT WARRANT, ENDORSE, GUARANTEE, OR ASSUME\n                RESPONSIBILITY FOR THE ACCURACY OR RELIABILITY OF ANY INFORMATION OFFERED BY THIRD-PARTY WEBSITES LINKED\n                THROUGH THE SITE OR ANY WEBSITE OR FEATURE LINKED IN ANY BANNER OR OTHER ADVERTISING. WE WILL NOT BE A\n                PARTY TO OR IN ANY WAY BE RESPONSIBLE FOR MONITORING ANY TRANSACTION BETWEEN YOU AND THIRD-PARTY\n                PROVIDERS OF PRODUCTS OR SERVICES.\n            </p>\n\n            <h3 className=\"text-center\">TESTIMONIALS DISCLAIMER</h3>\n\n            <p>\n                The Site may contain testimonials by users of our products and/or services. These testimonials reflect\n                the real-life experiences and opinions of such users. However, the experiences are personal to those\n                particular users, and may not necessarily be representative of all users of our products and/or\n                services. We do not claim, and you should not assume, that all users will have the same experiences.\n                YOUR INDIVIDUAL RESULTS MAY VARY.\n            </p>\n            <p>\n                The testimonials on the Site are submitted in various forms such as text, audio and/or video, and are\n                reviewed by us before being posted. They appear on the Site verbatim as given by the users, except for\n                the correction of grammar or typing errors. Some testimonials may have been shortened for the sake of\n                brevity where the full testimonial contained extraneous information not relevant to the general public.\n            </p>\n\n            <p>\n                The views and opinions contained in the testimonials belong solely to the individual user and do not\n                reflect our views and opinions. We are not affiliated with users who provide testimonials, and users are\n                not paid or otherwise compensated for their testimonials.\n            </p>\n        </>\n    );\n}\nexport default Disclaimer;\n","function Instruction() {\n    return (\n        <>\n            <h3>Instruction</h3>\n            <ol>\n                <li>\n\t\t\tSelect your ID type below.\n                </li>\n                <li>\n                    Background does not need to be 100% white but avoid photos with busy background for better results.\n                </li>\n                <li>Simply position the two green bars to cover the top of head and the bottom of chin.</li>\n                <li>\n                    Note that this website has not been optimized for mobile devices yet. Please use a laptop or desktop\n                    for a better experience.\n                </li>\n            </ol>\n        </>\n    );\n}\nexport default Instruction;\n","import React, { SyntheticEvent, useEffect } from \"react\";\nimport \"./App.css\";\nimport Cropper from \"cropperjs\";\nimport \"cropperjs/dist/cropper.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Button from \"react-bootstrap/Button\";\nimport Container from \"react-bootstrap/Container\";\nimport Form from \"react-bootstrap/Form\";\nimport ProgressBar from \"react-bootstrap/ProgressBar\";\nimport Disclaimer from \"./Disclaimer\";\nimport Instruction from \"./Instruction\";\nimport { InferenceSession, Tensor } from \"onnxruntime-web\";\nimport Pica from \"pica\";\nimport { DropdownButton, Dropdown } from \"react-bootstrap\";\n\ntype ID = {\n    name: string;\n    height: number;\n    width: number;\n    css_guide: string;\n    instruction_url: string | undefined;\n};\n\nconst ID_SPECS = [\n    {\n        name: \"US_PASSPORT\",\n        height: 600,\n        width: 600,\n        css_guide: \"us-passport\",\n        instruction_url: \"https://travel.state.gov/content/travel/en/passports/how-apply/photos.html\",\n    },\n    {\n        name: \"US_VISA\",\n        height: 600,\n        width: 600,\n        css_guide: \"us-passport\",\n        instruction_url: \"https://travel.state.gov/content/travel/en/us-visas/visa-information-resources/photos.html\",\n    },\n];\n\nconst MODEL_URLS = [\n    \"/static/u2net_human_seg.onnx.aa\",\n    \"/static/u2net_human_seg.onnx.ab\",\n    \"/static/u2net_human_seg.onnx.ac\",\n    \"/static/u2net_human_seg.onnx.ad\",\n    \"/static/u2net_human_seg.onnx.ae\",\n    \"/static/u2net_human_seg.onnx.af\",\n    \"/static/u2net_human_seg.onnx.ag\",\n    \"/static/u2net_human_seg.onnx.ah\",\n    \"/static/u2net_human_seg.onnx.ai\",\n    \"/static/u2net_human_seg.onnx.aj\",\n    \"/static/u2net_human_seg.onnx.ak\",\n];\n\nfunction adjustGuide(id: ID) {\n    let b1 = document.getElementsByClassName(\"dashed-h\")[0];\n    b1.setAttribute(\"class\", \"cropper-dashed dashed-\" + id.css_guide + \"-h1\");\n    let b2 = document.createElement(\"span\");\n    b2.setAttribute(\"class\", \"cropper-dashed dashed-\" + id.css_guide + \"-h2\");\n    b1.after(b2);\n}\n\nfunction App() {\n    const [cropper, setCropper] = React.useState<Cropper>();\n    const [imgURL, setImgURL] = React.useState<string>();\n    const [resultImgURL, setResultImgURL] = React.useState<string>();\n    const [composedResultImgURL, setComposedResultImgURL] = React.useState<string>();\n\n    // eslint-disable-next-line\n    const [currentID, setCurrentID] = React.useState<ID>(ID_SPECS[0]);\n    const [progressPercent, setProgressPercent] = React.useState<number>(0);\n    const [model, setModel] = React.useState<Uint8Array>();\n\n    const MODEL_INPUT_WIDTH = 320 as number;\n    const MODEL_INPUT_HEIGHT = 320 as number;\n\n    useEffect(() => {\n        prepareModel(MODEL_URLS).then((m) => {\n            setModel(m);\n        });\n    }, []);\n    function reset() {\n        cropper?.destroy();\n        setCropper(undefined);\n        setImgURL(\"\");\n        setResultImgURL(\"\");\n        setComposedResultImgURL(\"\");\n        setProgressPercent(0);\n        (document.getElementById(\"formFile\") as HTMLInputElement).value = \"\";\n    }\n\n    function inProgress() {\n        return progressPercent > 0 && progressPercent < 100;\n    }\n\n    const populateCropper = (e: SyntheticEvent<HTMLImageElement>) => {\n        if (cropper) {\n            cropper.destroy();\n        }\n        const thisImg = e.currentTarget;\n        let c = new Cropper(thisImg, {\n            aspectRatio: 1,\n            viewMode: 1,\n            minCropBoxWidth: 60,\n            minCropBoxHeight: 60,\n            ready: (_) => {\n                adjustGuide(currentID);\n            },\n        });\n        setCropper(c);\n    };\n\n    const composeResultImg = (e: SyntheticEvent<HTMLImageElement>) => {\n        const img = e.currentTarget;\n        const canvas = document.createElement(\"canvas\");\n        const h = img.naturalHeight;\n        const w = img.naturalWidth;\n        canvas.height = 2 * h;\n        canvas.width = 3 * w;\n        const context = canvas.getContext(\"2d\");\n        if (context) {\n            context.fillStyle = \"white\";\n            context.fillRect(0, 0, canvas.width, canvas.height);\n            for (let i = 0; i < 2; i++) {\n                for (let j = 0; j < 2; j++) {\n                    context.drawImage(img, (0.5 + i) * w, j * h);\n                }\n            }\n            context.beginPath();\n            // draw horizontal lines\n            context.moveTo(0.5 * w, h);\n            context.lineTo(2.5 * w, h);\n            // draw vertical lines\n            for (let i = 0; i < 3; i++) {\n                context.moveTo((i + 0.5) * w, 0);\n                context.lineTo((i + 0.5) * w, 2 * h);\n            }\n            context.stroke();\n            setComposedResultImgURL(canvas.toDataURL(\"image/jpeg\"));\n        }\n    };\n\n    const imageDataToFeeds = (img: ImageData): Promise<InferenceSession.OnnxValueMapType> => {\n        var floatArr = new Float32Array(MODEL_INPUT_WIDTH * MODEL_INPUT_HEIGHT * 3);\n        var floatArr2 = new Float32Array(MODEL_INPUT_WIDTH * MODEL_INPUT_HEIGHT * 3);\n        var j = 0;\n        for (let i = 0; i < img.data.length; i++) {\n            if (i % 4 !== 0) {\n                floatArr[j] = (img.data[i] as number) / 255; // red   color\n                j = j + 1;\n            }\n        }\n        var k = 0;\n        for (let i = 0; i < floatArr.length; i += 3) {\n            floatArr2[k] = floatArr[i]; // red   color\n            k = k + 1;\n        }\n        var l = 102400;\n        for (let i = 1; i < floatArr.length; i += 3) {\n            floatArr2[l] = floatArr[i]; // red   color\n            l = l + 1;\n        }\n        var m = 204800;\n        for (let i = 2; i < floatArr.length; i += 3) {\n            floatArr2[m] = floatArr[i]; // red   color\n            m = m + 1;\n        }\n        const feeds = { \"input.1\": new Tensor(\"float32\", floatArr2, [1, 3, MODEL_INPUT_WIDTH, MODEL_INPUT_HEIGHT]) };\n        return Promise.resolve(feeds);\n    };\n\n    const inferenceResultToImageData = (r: InferenceSession.ReturnType): Promise<ImageData> => {\n        const canvas = document.createElement(\"canvas\") as HTMLCanvasElement;\n        const ctx = canvas.getContext(\"2d\");\n        if (ctx) {\n            const pred = Object.values(r)[0];\n            var imgData = ctx.createImageData(MODEL_INPUT_WIDTH, MODEL_INPUT_HEIGHT);\n            for (let i = 0; i < pred.data.length * 4; i += 4) {\n                var pixelIndex = i;\n                var t = i / 4;\n                var p = pred.data[t] as number;\n                imgData.data[pixelIndex] = Math.round(p * 255);\n                imgData.data[pixelIndex + 3] = 0xff;\n            }\n            return Promise.resolve(imgData);\n        }\n        return Promise.reject(\"Failed to get context\");\n    };\n\n    const imageDataToCanvas = (imgData: ImageData): Promise<HTMLCanvasElement> => {\n        const canvas = document.createElement(\"canvas\") as HTMLCanvasElement;\n        canvas.width = imgData.width;\n        canvas.height = imgData.height;\n        const ctx2 = canvas.getContext(\"2d\");\n        ctx2?.putImageData(imgData, 0, 0);\n        return Promise.resolve(canvas);\n    };\n\n    const applyBackgroundMask = (imgAndMask: ImageData[]): Promise<ImageData> => {\n        let img = imgAndMask[0];\n        const mask = imgAndMask[1];\n        for (let i = 0; i < mask.data.length; i += 4) {\n            let v = 0;\n            v = mask.data[i];\n            if (v < 250) {\n                img.data[i] = 0xff;\n                img.data[i + 1] = 0xff;\n                img.data[i + 2] = 0xff;\n            }\n            img.data[i + 3] = mask.data[i + 3];\n        }\n        return Promise.resolve(img);\n    };\n\n    async function prepareModel(urls: string[]): Promise<Uint8Array> {\n        let totalSize = 0 as number;\n        let arrays = await Promise.all(\n            urls\n                .map((u) => {\n                    return fetch(u);\n                })\n                .map(async (p) => {\n                    let a = await (await p).arrayBuffer();\n                    return new Uint8Array(a);\n                })\n        );\n\n        arrays.forEach((a) => {\n            totalSize += a.length;\n        });\n\n        let ret = new Uint8Array(totalSize);\n        let counter = 0;\n        arrays.forEach((v, _) => {\n            ret.set(v, counter);\n            counter += v.length;\n        });\n        return Promise.resolve(ret);\n    }\n\n    const handleSubmit = (event: React.FormEvent) => {\n        event.preventDefault();\n        if (cropper == null) {\n            alert(\"select and crop a photo before uploading.\");\n            return;\n        }\n\n        const ctx = cropper\n            .getCroppedCanvas({\n                maxHeight: MODEL_INPUT_HEIGHT,\n                minHeight: MODEL_INPUT_HEIGHT,\n                maxWidth: MODEL_INPUT_WIDTH,\n                minWidth: MODEL_INPUT_WIDTH,\n            })\n            .getContext(\"2d\", { alpha: true });\n\n        if (ctx) {\n            var imageData = ctx.getImageData(0, 0, MODEL_INPUT_WIDTH, MODEL_INPUT_HEIGHT);\n            const to = document.createElement(\"canvas\") as HTMLCanvasElement;\n            to.width = currentID.width;\n            to.height = currentID.height;\n            const pica = Pica();\n            let origImgData = cropper\n                .getCroppedCanvas({\n                    maxWidth: currentID.width,\n                    minWidth: currentID.width,\n                    maxHeight: currentID.height,\n                    minHeight: currentID.height,\n                })\n                .getContext(\"2d\")\n                ?.getImageData(0, 0, currentID.width, currentID.height) as ImageData;\n\n            imageDataToFeeds(imageData).then((feeds: InferenceSession.OnnxValueMapType) => {\n                setProgressPercent(10);\n                if (model) {\n                    InferenceSession.create(model, {}).then((sess: InferenceSession) => {\n                        setProgressPercent(50);\n                        sess.run(feeds)\n                            .then((r) => {\n                                setProgressPercent(90);\n                                return inferenceResultToImageData(r);\n                            })\n                            .then((i) => {\n                                setProgressPercent(95);\n                                return imageDataToCanvas(i);\n                            })\n                            .then((from: HTMLCanvasElement) => {\n                                pica.resize(from, to)\n                                    .then((result: HTMLCanvasElement) => {\n                                        const ctx = result.getContext(\"2d\");\n                                        if (ctx) {\n                                            let filterData = ctx.getImageData(0, 0, currentID.width, currentID.height);\n                                            return Promise.resolve([origImgData, filterData]);\n                                        }\n                                        return Promise.reject(\"error generate filter and original image data\");\n                                    })\n                                    .then((v) => {\n                                        setProgressPercent(98);\n                                        return applyBackgroundMask(v);\n                                    })\n                                    .then(imageDataToCanvas)\n                                    .then((c: HTMLCanvasElement) => {\n                                        setProgressPercent(100);\n                                        setResultImgURL(c.toDataURL(\"image/jpeg\"));\n                                    });\n                            });\n                    });\n                }\n            });\n        }\n    };\n\n    return (\n        <>\n            <Container className=\"p-3\">\n                <Container className=\"p-5 mb-4 bg-light rounded-3\">\n                    <h1 className=\"header text-center\"> Welcome To freeidphoto.com </h1>\n                </Container>\n                <Container className=\"row mb-4\">\n                    <Container className=\"col\">\n                        <ProgressBar animated hidden={progressPercent === 0} now={progressPercent} />\n                    </Container>\n                </Container>\n                <Container className=\"row\">\n                    <Container className=\"col-lg-4\">\n                        <Container>\n                            <Instruction />\n                        </Container>\n                        <Container className=\"mb-3\">\n                            <DropdownButton\n                                onSelect={(eventKey, _) => {\n                                    if (eventKey) {\n                                        setCurrentID(ID_SPECS[Number(eventKey)]);\n                                    }\n                                }}\n                                title={currentID.name}\n                                className=\"mb-1\"\n                            >\n                                {ID_SPECS.map((id, idx) => {\n                                    return (\n                                        <Dropdown.Item eventKey={idx} key={idx}>\n                                            {id.name}\n                                        </Dropdown.Item>\n                                    );\n                                })}\n                            </DropdownButton>\n                            <h6>\n                                See&nbsp;\n                                <a href={currentID.instruction_url} target=\"_blank\" rel=\"noreferrer\">\n                                    here\n                                </a>\n                                &nbsp; for detailed requirements.\n                            </h6>\n                        </Container>\n                        <Container>\n                            <Form.Group controlId=\"formFile\" className=\"mb-3\">\n                                <Form.Label>Select your photo:</Form.Label>\n                                <Form.Control\n                                    type=\"file\"\n                                    onChange={(e: React.FormEvent) => {\n                                        e.preventDefault();\n                                        const files = (e.target as HTMLInputElement).files;\n                                        if (files && files.length > 0 && files[0].type.match(/^image\\//)) {\n                                            let reader = new FileReader();\n                                            reader.onload = (e) => {\n                                                setImgURL(e.target?.result as string);\n                                            };\n                                            reader.readAsDataURL(files[0]);\n                                        }\n                                    }}\n                                />\n                            </Form.Group>\n                            <Button\n                                variant=\"primary\"\n                                onClick={handleSubmit}\n                                disabled={inProgress() || !imgURL || !model}\n                            >\n                                Submit\n                            </Button>\n                            <Button variant=\"danger\" className=\"float-end\" onClick={reset} disabled={inProgress()}>\n                                Reset\n                            </Button>\n                        </Container>\n                    </Container>\n                    <Container className=\"col-lg-8 text-center mt-3\">\n                        <Container hidden={progressPercent === 100 || !imgURL}>\n                            <img alt=\"\" src={imgURL} onLoad={populateCropper}></img>\n                        </Container>\n                        <Container hidden={!resultImgURL || inProgress()}>\n                            <h2>Click the image to download.</h2>\n                            <a href={composedResultImgURL} download=\"composed_result.jpeg\">\n                                <img alt=\"\" src={composedResultImgURL}></img>\n                            </a>\n                            <a href={resultImgURL} download=\"result.jpeg\">\n                                <img width={200} alt=\"\" src={resultImgURL} onLoad={composeResultImg}></img>\n                            </a>\n                        </Container>\n                    </Container>\n                </Container>\n\n                <Container className=\"mt-3\">\n                    <h3 className=\"text-center\">Why do I make this website?</h3>\n                    <p>\n                        There are so many other ID photo websites that claim to be free. However, some only produces\n                        greyscale photos. Some does not remove background. Some prints their watermarks to make result\n                        photos unusable. They eventually want you to pay in order to get what you want: a white\n                        background photo that is ready to print on a 6\" * 4\" photo paper. This website is FREE to use\n                        and will always be.\n                    </p>\n                    <p>\n                        Printing yourself at CVS, Walgreens or other stroes is less than $1 for 4 photos while photo\n                        stores charge more than $10 for only 2 photos.\n                    </p>\n                    <p>\n                        This is just a hobby project. Your feedback, suggestions, and kudos are welcomed and\n                        appreciated. Please email me at <a href=\"mailto:freeidphoto@gmail.com\">freeidphoto@gmail.com</a>\n                        .\n                    </p>\n                </Container>\n                <Container className=\"row mt-5\">\n                    <Disclaimer />\n                </Container>\n            </Container>\n        </>\n    );\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\") as HTMLElement);\nroot.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}